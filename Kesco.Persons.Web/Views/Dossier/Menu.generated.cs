#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

namespace ASP
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Net;
    using System.Text;
    using System.Web;
    using System.Web.Helpers;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    
    #line 3 "..\..\Views\Dossier\Menu.cshtml"
    using Kesco.Persons.Web;
    
    #line default
    #line hidden
    
    #line 4 "..\..\Views\Dossier\Menu.cshtml"
    using Kesco.Persons.Web.Models.Dossier;
    
    #line default
    #line hidden
    
    #line 5 "..\..\Views\Dossier\Menu.cshtml"
    using Kesco.Web.Mvc;
    
    #line default
    #line hidden
    
    #line 6 "..\..\Views\Dossier\Menu.cshtml"
    using Kesco.Web.Mvc.UI;
    
    #line default
    #line hidden
    using MvcJqGrid;
    
    #line 2 "..\..\Views\Dossier\Menu.cshtml"
    using Resources;
    
    #line default
    #line hidden
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Views/Dossier/Menu.cshtml")]
    public partial class _Views_Dossier_Menu_cshtml : Kesco.Persons.Web.SiteViewPage<List<Kesco.Persons.BusinessLogic.Dossier.PersonMenuItem>>
    {
        public _Views_Dossier_Menu_cshtml()
        {
        }
        public override void Execute()
        {
            
            #line 7 "..\..\Views\Dossier\Menu.cshtml"
  
	int PersonID = (int) ViewData["PersonID"];
	int AccessLevel = (int)ViewData["AccessLevel"];
	bool Verified = (bool)ViewData["Verified"];
    bool IsBProject = (bool)ViewData["IsBProject"];
    
    /* Ищем в URL параметр hideOldVer, пишем его в сессию. Требуется для скрытия кнопки "Открыть в старой версии"  */
    string hideOldVerRequest = HttpContext.Current.Request["hideOldVer"];
    var hideOldVerSession = HttpContext.Current.Session["hideOldVer"];
    string hideOldVer = "false";

    if (!String.IsNullOrEmpty(hideOldVerRequest))
    {
        HttpContext.Current.Session["hideOldVer"] = hideOldVer = hideOldVerRequest;
    }
    else if (hideOldVerSession != null)
    {
        hideOldVer = hideOldVerSession.ToString();
    }

            
            #line default
            #line hidden
WriteLiteral("\r\n");

            
            #line 27 "..\..\Views\Dossier\Menu.cshtml"
Write(Html.CommonScriptCode("Dossier_MenuScript",
item => new System.Web.WebPages.HelperResult(__razor_template_writer => {

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, "<script>\r\n \r\n\t");

WriteLiteralTo(__razor_template_writer, @"
	(function(window, undefined) {		
		ViewModel.prevVersionUrl  = """";
	})(this);

    $(document).ready(function() {
        function dispatchMenuCommand(ev, ui) {
            var cmd = ui.item.data('command');
            switch (cmd) {
            case 'printRequisites':
                var url = """);

            
            #line 40 "..\..\Views\Dossier\Menu.cshtml"
WriteTo(__razor_template_writer, Configuration.AppSettings.URI_store_person);

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, "?personId=");

            
            #line 40 "..\..\Views\Dossier\Menu.cshtml"
                                                   WriteTo(__razor_template_writer, PersonID);

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, "\";\r\n                Kesco.windowOpen(url, \"_storePerson");

            
            #line 41 "..\..\Views\Dossier\Menu.cshtml"
                    WriteTo(__razor_template_writer, PersonID);

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, "\");\r\n                break;\r\n            case \'createJuridical\':\r\n               " +
" openPopupWindow(\'");

            
            #line 44 "..\..\Views\Dossier\Menu.cshtml"
 WriteTo(__razor_template_writer, Url.Action("Index", "Juridical"));

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, @"',
                    null,
                    function(result) {
                        if (result) {
                            var personID = $.isArray(result) ? result[0].value : result;
                            if (personID)
                                openPopupWindow(
                                    '");

            
            #line 51 "..\..\Views\Dossier\Menu.cshtml"
      WriteTo(__razor_template_writer, Url.Action("Index", "Dossier"));

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, @"?id=' + personID,
                                    null,
                                    null,
                                    ""wndPerson"" + personID,
                                    800,
                                    600,
                                    { close: false });
                        }
                    },
                    ""wndPersonCreateJuridical"",
                    800,
                    600,
                    { close: false });
                break;
            case 'createIndividual':
                openPopupWindow('");

            
            #line 66 "..\..\Views\Dossier\Menu.cshtml"
 WriteTo(__razor_template_writer, Url.Action("Index", "Natural"));

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, @"',
                    null,
                    function(result) {
                        if (result) {
                            var personID = $.isArray(result) ? result[0].value : result;
                            if (personID)
                                openPopupWindow(
                                    '");

            
            #line 73 "..\..\Views\Dossier\Menu.cshtml"
      WriteTo(__razor_template_writer, Url.Action("Index", "Dossier"));

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, @"?id=' + personID,
                                    null,
                                    null,
                                    ""wndPerson"" + personID,
                                    800,
                                    600,
                                    { close: false });
                        }
                    },
                    ""wndPersonCreateNatural"",
                    800,
                    600,
                    { close: false });
                break;
            case 'searchPerson':
                openPopupWindow('");

            
            #line 88 "..\..\Views\Dossier\Menu.cshtml"
 WriteTo(__razor_template_writer, Url.Action("Index", "Search"));

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, @"',
                    null,
                    null,
                    ""wndSearchPerson"",
                    800,
                    600,
                    { close: false });
                break;
            case 'searchDocs':
                $.srv4js('SEARCHDISCONNECTED', { args: 'persons=");

            
            #line 97 "..\..\Views\Dossier\Menu.cshtml"
                                 WriteTo(__razor_template_writer, PersonID);

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, "\', callback: docView_Result });\r\n                break;\r\n            case \'printD" +
"ossier\':\r\n                window.print();\r\n                break;\r\n            c" +
"ase \'deletePerson\':\r\n                openPopupWindow(\'");

            
            #line 103 "..\..\Views\Dossier\Menu.cshtml"
 WriteTo(__razor_template_writer, Url.Action("Delete", "Dossier", new { id = PersonID }));

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, @"',
                    null,
                    function(result) {
                        if (result) {
                            var personID = $.isArray(result) ? result[0] : result;
                            if (personID)
                                window.location.href = '");

            
            #line 109 "..\..\Views\Dossier\Menu.cshtml"
                         WriteTo(__razor_template_writer, Url.Action("Index", "Dossier"));

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, @"' +
                                    ""?id="" +
                                    personID;
                            else closeDialog();
                        }
                    },
                    ""wndPersonDelete"",
                    800,
                    600,
                    { close: false });
                break;

            case 'addToPerson':
                    var w = 800, h = 600;
                    var _url = ui.item.data('url').toLowerCase();

                var isOldApp = _url.indexOf('/mvc/') == -1;

                var callback = function () {window.location.href = window.location.href; };

                if (_url.indexOf('store.aspx') != -1) {
                  
                    _url = _url + (_url.indexOf('?')!=-1?'&':'?') + 'mvc=1';
                    _url = _url + '&callbackUrl='+ encodeURIComponent('");

            
            #line 132 "..\..\Views\Dossier\Menu.cshtml"
                                        WriteTo(__razor_template_writer, Url.FullPathAction("DialogResult"));

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, @"');
                    openPopupWindow(_url, null,  function (value) { window.location.href = window.location.href; window.focus(); },
                    'wndNewStore', null, null);

                    break;
                }

                if (_url.indexOf('link.aspx') != -1) {
                    w = 520;
                    h = 300;
                }
                if (_url.indexOf('card.aspx') != -1) {
                    w = 500;
                    h = 250;
                    callback = function(result) {
                        if ($.isArray(result)) {
                            editProps(0,
                                {
                                    type: 'POST',
                                    callbackUrl: '");

            
            #line 151 "..\..\Views\Dossier\Menu.cshtml"
                   WriteTo(__razor_template_writer, Url.FullPathAction("DialogResult"));

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, "\',\r\n                                    Requisites: {\r\n                          " +
"              ID: 0,\r\n                                        PersonID: ");

            
            #line 154 "..\..\Views\Dossier\Menu.cshtml"
                   WriteTo(__razor_template_writer, PersonID);

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, @",
                                        From: result[0].From,
                                        To: result[0].To
                                    }
                                },
                                null,
                                null)
                        }
                    }
                }

                if (isOldApp)
                    DialogPageOpen(_url,
                        $.validator.format('center:yes;status:no;help:no;resizable:yes;width:{0};height:{1};', w, h),
                        callback);
                else
                    openPopupWindow(_url, null, callback, ""wndPersonAdd"", w, h);
                break;

            case 'toggleChangedBy':
                window.ViewModel.Params.PersonChange(window.ViewModel.Params.PersonChange() == 1 ? 0 : 1);
                ev.stopImmediatePropagation();
                $('.changed').toggle(window.ViewModel.Params.PersonChange() == 1);
                return false;
                break;
                case 'toggleOldProps':
                    var x = window.ViewModel.Params.PersonDateOld();
                    window.ViewModel.Params.PersonDateOld((x == 1) ? 0 : 1);
                    ev.stopImmediatePropagation();
                    window.location = '");

            
            #line 183 "..\..\Views\Dossier\Menu.cshtml"
       WriteTo(__razor_template_writer, Url.Action("Index"));

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, "?id=");

            
            #line 183 "..\..\Views\Dossier\Menu.cshtml"
                                WriteTo(__razor_template_writer, PersonID);

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, @"';
                return false;
                break;
                case 'toggleStoreOldProps':
                    var x = window.ViewModel.Params.PersonDateOld();
                    window.ViewModel.Params.PersonDateOld((x == 2) ? 0 : 2);
                    ev.stopImmediatePropagation();
                    window.location = '");

            
            #line 190 "..\..\Views\Dossier\Menu.cshtml"
       WriteTo(__razor_template_writer, Url.Action("Index"));

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, "?id=");

            
            #line 190 "..\..\Views\Dossier\Menu.cshtml"
                                WriteTo(__razor_template_writer, PersonID);

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, @"';
                    return false;
                break;
            default:
                break;
            }
        }

        $(""#menyBar"").menubar({
            menuIcon: true,
            buttons: true,
            position: {
                within: $(""#dialogHeader"").add(window).first()
            },
            select: dispatchMenuCommand
        }).show();

        if (window.ViewModel.Params.PersonChange() == 0) $('.changed').hide();
    });

	function docView_Result(rez, obj) {
		//значение контрола уже сброшено
		if (!rez.error)
			switch (rez.value) {
			case '-1': alert('Ошибка взаимодействия с архивом документов!'); break;
			case '0': break;
			default:
				break;
		}
		else
			alert(rez.errorMsg);
	}
</script>");

            
            #line 222 "..\..\Views\Dossier\Menu.cshtml"
       })));

            
            #line default
            #line hidden
WriteLiteral("\r\n<style");

WriteLiteral(" type=\"text/css\"");

WriteLiteral(">\r\n\t#oldVersion { white-space:nowrap; border-width:0px; font-weight:bold; backgro" +
"und-color:inherit; float:right; }\r\n\t#oldVersion a { text-decoration: none; }\r\n\t#" +
"oldVersion a:hover { text-decoration: underline; }\r\n</style>\r\n\r\n<ul");

WriteLiteral(" id=\"menyBar\"");

WriteLiteral(" class=\"menubar\"");

WriteLiteral(" style=\"float: left; display: none;\"");

WriteLiteral(">\r\n\t<li>\r\n\t\t<a");

WriteLiteral(" href=\"#Edit\"");

WriteLiteral(">");

            
            #line 231 "..\..\Views\Dossier\Menu.cshtml"
                   Write(Resources.Persons_Dossier_Menu_Person);

            
            #line default
            #line hidden
WriteLiteral("</a>\r\n\t\t<ul>\r\n\t\t\t<li");

WriteLiteral(" data-command=\"createJuridical\"");

WriteLiteral("><a");

WriteLiteral(" href=\"javascript: void(0);\"");

WriteLiteral("><span");

WriteLiteral(" class=\"ui-icon ui-icon-home\"");

WriteLiteral("></span>");

            
            #line 233 "..\..\Views\Dossier\Menu.cshtml"
                                                                                                                   Write(Resources.Persons_Dossier_Menu_NewJur);

            
            #line default
            #line hidden
WriteLiteral("</a></li>\r\n\t\t\t<li");

WriteLiteral(" data-command=\"createIndividual\"");

WriteLiteral("><a");

WriteLiteral(" href=\"javascript: void(0);\"");

WriteLiteral("><span");

WriteLiteral(" class=\"ui-icon ui-icon-person\"");

WriteLiteral("></span>");

            
            #line 234 "..\..\Views\Dossier\Menu.cshtml"
                                                                                                                      Write(Resources.Persons_Dossier_Menu_NewInd);

            
            #line default
            #line hidden
WriteLiteral("</a></li>\r\n\t\t\t<li");

WriteLiteral(" data-command=\"searchPerson\"");

WriteLiteral("><a");

WriteLiteral(" href=\"javascript: void(0);\"");

WriteLiteral("><span");

WriteLiteral(" class=\"ui-icon ui-icon-search\"");

WriteLiteral("></span>");

            
            #line 235 "..\..\Views\Dossier\Menu.cshtml"
                                                                                                                  Write(Resources.Persons_Dossier_Menu_Search);

            
            #line default
            #line hidden
WriteLiteral("</a></li>\r\n\t\t\t<li");

WriteLiteral(" data-command=\"searchDocs\"");

WriteLiteral("><a");

WriteLiteral(" href=\"javascript: void(0);\"");

WriteLiteral("><span");

WriteLiteral(" class=\"ui-icon ui-icon-copy\"");

WriteLiteral("></span>");

            
            #line 236 "..\..\Views\Dossier\Menu.cshtml"
                                                                                                              Write(Resources.Persons_Dossier_Menu_Docs);

            
            #line default
            #line hidden
WriteLiteral("</a></li>\r\n\t\t\t<li");

WriteLiteral(" data-command=\"printDossier\"");

WriteLiteral("><a");

WriteLiteral(" href=\"javascript: void(0);\"");

WriteLiteral("><span");

WriteLiteral(" class=\"ui-icon ui-icon-print\"");

WriteLiteral("></span>");

            
            #line 237 "..\..\Views\Dossier\Menu.cshtml"
                                                                                                                 Write(Resources.Persons_Dossier_Menu_Print);

            
            #line default
            #line hidden
WriteLiteral("</a></li>\r\n           \r\n");

            
            #line 239 "..\..\Views\Dossier\Menu.cshtml"
            
            
            #line default
            #line hidden
            
            #line 239 "..\..\Views\Dossier\Menu.cshtml"
             if (IsBProject)
            { 

            
            #line default
            #line hidden
WriteLiteral("                <li");

WriteLiteral(" data-command=\"printRequisites\"");

WriteLiteral("><a");

WriteLiteral(" href=\"javascript: void(0);\"");

WriteLiteral("><span");

WriteLiteral(" class=\"ui-icon ui-icon-print\"");

WriteLiteral("></span>");

            
            #line 241 "..\..\Views\Dossier\Menu.cshtml"
                                                                                                                        Write(Resources.Persons_Synchronize_Differences_Requisites);

            
            #line default
            #line hidden
WriteLiteral("</a></li>\r\n");

            
            #line 242 "..\..\Views\Dossier\Menu.cshtml"
            }

            
            #line default
            #line hidden
WriteLiteral("\r\n");

            
            #line 244 "..\..\Views\Dossier\Menu.cshtml"
			
            
            #line default
            #line hidden
            
            #line 244 "..\..\Views\Dossier\Menu.cshtml"
             if (AccessLevel > 3 || (!Verified && AccessLevel == 3))
			{

            
            #line default
            #line hidden
WriteLiteral("\t\t\t\t<li");

WriteLiteral(" data-command=\"deletePerson\"");

WriteLiteral("><a");

WriteLiteral(" href=\"javascript: void(0);\"");

WriteLiteral("><span");

WriteLiteral(" class=\"ui-icon ui-icon-trash\"");

WriteLiteral("></span>");

            
            #line 246 "..\..\Views\Dossier\Menu.cshtml"
                                                                                                                     Write(Resources.GUI_Button_Delete.ToLower());

            
            #line default
            #line hidden
WriteLiteral("</a></li>\r\n");

            
            #line 247 "..\..\Views\Dossier\Menu.cshtml"
			}

            
            #line default
            #line hidden
WriteLiteral("\t\t</ul>\r\n\t</li>\r\n");

            
            #line 250 "..\..\Views\Dossier\Menu.cshtml"
	
            
            #line default
            #line hidden
            
            #line 250 "..\..\Views\Dossier\Menu.cshtml"
     if (Model.Count>0) {

            
            #line default
            #line hidden
WriteLiteral("\t<li>\r\n\t\t<a");

WriteLiteral(" href=\"#Edit\"");

WriteLiteral(">");

            
            #line 252 "..\..\Views\Dossier\Menu.cshtml"
                   Write(Resources.Persons_Dossier_Menu_AddToPerson);

            
            #line default
            #line hidden
WriteLiteral("</a>\r\n\t\t<ul>\r\n");

            
            #line 254 "..\..\Views\Dossier\Menu.cshtml"
			
            
            #line default
            #line hidden
            
            #line 254 "..\..\Views\Dossier\Menu.cshtml"
             foreach (var item in Model) {
				if (item.Separator == 1) {

            
            #line default
            #line hidden
WriteLiteral("\t\t\t\t\t<li><span></span></li>\r\n");

            
            #line 257 "..\..\Views\Dossier\Menu.cshtml"
				}

            
            #line default
            #line hidden
WriteLiteral("\t\t\t\t<li");

WriteLiteral(" data-command=\"addToPerson\"");

WriteLiteral(" data-url=\"");

            
            #line 258 "..\..\Views\Dossier\Menu.cshtml"
                                                     Write(Url.GetURL(item, PersonID));

            
            #line default
            #line hidden
WriteLiteral("\"");

WriteLiteral("\r\n\t\t\t\t\t><a");

WriteLiteral(" href=\"javascript: void(0);\"");

WriteLiteral(">");

            
            #line 259 "..\..\Views\Dossier\Menu.cshtml"
                                                Write(item.Caption);

            
            #line default
            #line hidden
WriteLiteral("</a></li>\r\n");

            
            #line 260 "..\..\Views\Dossier\Menu.cshtml"
			}

            
            #line default
            #line hidden
WriteLiteral("\t\t</ul>\r\n\t</li>\r\n");

            
            #line 263 "..\..\Views\Dossier\Menu.cshtml"
	}

            
            #line default
            #line hidden
WriteLiteral("\t<li>\r\n\t\t<a");

WriteLiteral(" href=\"#Edit\"");

WriteLiteral(">");

            
            #line 265 "..\..\Views\Dossier\Menu.cshtml"
                   Write(Resources.Persons_Dossier_Menu_View);

            
            #line default
            #line hidden
WriteLiteral("</a>\r\n\t\t<ul>\r\n\t\t\t<li");

WriteLiteral(" data-command=\"toggleChangedBy\"");

WriteLiteral("><a");

WriteLiteral(" href=\"javascript: void(0);\"");

WriteLiteral("><span");

WriteLiteral(" class=\"ui-icon ui-icon-check\"");

WriteLiteral(" data-bind=\"visible: window.ViewModel.Params.PersonChange()\"");

WriteLiteral("></span>");

            
            #line 267 "..\..\Views\Dossier\Menu.cshtml"
                                                                                                                                                                                Write(Resources.Persons_Dossier_Menu_ChangedBy);

            
            #line default
            #line hidden
WriteLiteral("</a></li>\r\n            <li");

WriteLiteral(" data-command=\"toggleOldProps\"");

WriteLiteral("><a");

WriteLiteral(" href=\"javascript: void(0);\"");

WriteLiteral("><span");

WriteLiteral(" class=\"ui-icon ui-icon-check\"");

WriteLiteral(" data-bind=\"visible: (window.ViewModel.Params.PersonDateOld()==1?1:0)\"");

WriteLiteral("></span>");

            
            #line 268 "..\..\Views\Dossier\Menu.cshtml"
                                                                                                                                                                                         Write(Resources.Persons_Dossier_Menu_OldProps);

            
            #line default
            #line hidden
WriteLiteral("</a></li>\r\n            \r\n            <li");

WriteLiteral(" data-command=\"toggleStoreOldProps\"");

WriteLiteral("><a");

WriteLiteral(" href=\"javascript: void(0);\"");

WriteLiteral("><span");

WriteLiteral(" class=\"ui-icon ui-icon-check\"");

WriteLiteral(" data-bind=\"visible: (window.ViewModel.Params.PersonDateOld()==2?1:0)\"");

WriteLiteral("></span>");

            
            #line 270 "..\..\Views\Dossier\Menu.cshtml"
                                                                                                                                                                                              Write(Resources.Persons_Dossier_Menu_StoreOldProps);

            
            #line default
            #line hidden
WriteLiteral("</a></li>\r\n\t\t</ul>\r\n\t</li>\r\n</ul>\r\n\r\n");

        }
    }
}
#pragma warning restore 1591
